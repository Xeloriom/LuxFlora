<!DOCTYPE html>
<html lang="fr" class="bg-gray-50">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Suivi de Livraison - LuxFlora</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Abel&family=Great+Vibes&family=Julius+Sans+One&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 font-inter text-gray-900">

<section class="px-6 py-10 max-w-screen-xl mx-auto">

  <!-- Header -->
  <div class="flex items-center justify-between bg-gradient-to-r from-black via-gray-900 to-black rounded-2xl px-6 py-6 shadow-lg mb-10">
    <div class="flex items-center space-x-4 text-white">
      <img src="../img/img_4.png" alt="LuxFlora Logo" class="w-12 h-12 object-contain bg-white rounded-full" />
      <h1 class="text-2xl tracking-wide font-light" style="font-family: 'Julius Sans One', sans-serif;">
        Suivi de commande
      </h1>
    </div>
    <span class="text-sm italic text-gray-300 hidden md:block">Suivi sécurisé et élégant</span>
  </div>

  <div class="lg:flex lg:gap-10">
    <!-- Colonne gauche: détails commande -->
    <div class="flex-1 space-y-8">
      <!-- Étapes de livraison adaptées -->
      <div class="bg-white rounded-2xl shadow-md p-8 border border-gray-100">
        <h2 class="text-xl font-semibold mb-6 border-b pb-2">État de la commande</h2>
        <div id="deliverySteps" class="flex justify-between items-center relative mb-6"></div>
      </div>

      <!-- Détails de commande avec images -->
      <div class="bg-white rounded-2xl shadow-md p-8 border border-gray-100">
        <h2 class="text-xl font-semibold mb-6 border-b pb-2">Produits commandés</h2>
        <ul id="cartItemsList" class="divide-y divide-gray-200 max-h-96 overflow-y-auto"></ul>
        <div class="mt-6 flex justify-between text-lg font-semibold">
          <span>Total</span>
          <span id="cartTotalDisplay">0 €</span>
        </div>
      </div>

      <!-- Informations client et livraison -->
      <div class="bg-white rounded-2xl shadow-md p-8 border border-gray-100">
        <h2 class="text-xl font-semibold mb-6 border-b pb-2">Informations client</h2>
        <div id="clientInfo"></div>

        <!-- Bouton retour à l'accueil -->
        <div class="mt-8 text-center">
          <a href="../index.html" class="inline-block  bg-black text-white font-semibold px-6 py-3 rounded-full shadow-lg hover:scale-105 transform transition">
            ← Retour à l'accueil
          </a>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  const order = JSON.parse(localStorage.getItem("lastOrder") || "{}");

  // Définir les étapes selon mode de livraison et paiement
  let steps = [];
  if(order.deliveryType === 'delivery'){
    steps = ['Préparée', 'En route', 'Livrée'];
  } else {
    if(order.paymentMethod === 'on-site'){
      steps = ['Préparée', 'Prête au retrait', 'Retirée'];
    } else {
      steps = ['Préparée', 'Prête au retrait', 'Retirée'];
    }
  }

  const deliveryDiv = document.getElementById('deliverySteps');
  deliveryDiv.innerHTML = steps.map((step, idx) => `
    <div class="flex flex-col items-center text-center w-1/3">
      <div class="w-10 h-10 rounded-full ${idx === 0 ? 'bg-green-600' : 'bg-gray-300'} text-white flex items-center justify-center font-bold">
        ${idx === 0 ? '✓' : idx + 1}
      </div>
      <span class="text-sm mt-2">${step}</span>
    </div>
  `).join('');

  // Détails produits
  const cartList = document.getElementById("cartItemsList");
  if(order.cart && order.cart.length > 0){
    cartList.innerHTML = order.cart.map(item => `
      <li class="py-3 flex items-center gap-4">
        <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-xl shadow-sm"/>
        <div class="flex-1">
          <p class="font-medium text-gray-900">${item.name}</p>
          <p class="text-gray-600">${item.price.toFixed(2)} €</p>
        </div>
      </li>
    `).join("");
    document.getElementById("cartTotalDisplay").textContent = order.total;
  } else {
    cartList.innerHTML = `<p class="text-gray-500 text-center py-4">Aucun produit trouvé.</p>`;
  }

  // Informations client
  const clientDiv = document.getElementById("clientInfo");
  if(order.name){
    let html = `
      <p class="mb-2"><span class="font-semibold">Nom:</span> ${order.name}</p>
      <p class="mb-2"><span class="font-semibold">Email:</span> ${order.email}</p>
      <p class="mb-2"><span class="font-semibold">Téléphone:</span> ${order.phone}</p>
      <p class="mb-2"><span class="font-semibold">Mode de réception:</span> ${order.deliveryType === 'delivery' ? 'Livraison' : 'Retrait en boutique'}</p>
      <p class="mb-2"><span class="font-semibold">Mode de paiement:</span> ${order.paymentMethod === 'online' ? 'En ligne' : 'Sur place'}</p>
    `;
    if(order.deliveryType === 'delivery' && order.address){
      html += `<p class="mb-2"><span class="font-semibold">Adresse:</span> ${order.address.street}, ${order.address.city}, ${order.address.zip}, ${order.address.country}</p>`;
    }
    clientDiv.innerHTML = html;
  } else {
    clientDiv.innerHTML = `<p class="text-gray-500">Aucune information client trouvée.</p>`;
  }
</script>

</body>
</html>
